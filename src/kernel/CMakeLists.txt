set(KERNEL_SOURCES
    ${CMAKE_CURRENT_SOURCE_DIR}/kpanic.c
    ${CMAKE_CURRENT_SOURCE_DIR}/kmalloc.c
    ${CMAKE_CURRENT_SOURCE_DIR}/kstdlib.c
    ${CMAKE_CURRENT_SOURCE_DIR}/pmm.c
    ${CMAKE_CURRENT_SOURCE_DIR}/printk.c
    ${CMAKE_CURRENT_SOURCE_DIR}/salloc.c
    ${CMAKE_CURRENT_SOURCE_DIR}/vmm.c
    ${CMAKE_CURRENT_SOURCE_DIR}/handle.c
    )

    if (MOS_GRAPHICS_ENABLED)
        LIST(APPEND KERNEL_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/graphics.c)
        LIST(APPEND KERNEL_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/compositor.c)
    endif()

    if (MOS_BUILD_MODE STREQUAL "DEBUG")
        LIST(APPEND KERNEL_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/printk.c)
        if (MOS_PORT_E9_ENABLED)
            LIST(APPEND KERNEL_SOURCES ${CMAKE_CURRENT_SOURCE_DIR}/kdebug.c)
        endif()
    endif()

compile_lib(
    NAME kernel
    SOURCES ${KERNEL_SOURCES}
    FLAGS ${MOS_KERNEL_GCC_FLAGS}
    DEFINITIONS ${MOS_KERNEL_GCC_DEFINITIONS}
    INCLUDE_DIRECTORIES ${MOS_KERNEL_GCC_INCLUDE_DIRS}
    )
